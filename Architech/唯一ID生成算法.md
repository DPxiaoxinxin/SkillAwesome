# 唯一ID生成算法

# 独立数据库自增id

* 往一个独立库的一个独立表里插入一条没什么业务含义的数据，然后获取一个数据库自增的一个id。拿到这个id之后再往对应的分库分表里去写入
* 方便简单，但在高并发下会有瓶颈



# uuid

* 每个系统本地用UUID生成一个全局唯一的id
* 作为主键性能太差了，不适合用于主键



# 获取系统当前时间

* 获取当前时间作为全局唯一的id
* 并发很高的时候，比如一秒并发几千，会有重复的情况
* 如果业务上能接受，可以将业务字段值跟当前时间拼接起来，组成一个全局唯一的编号：**时间戳 + 用户id + 业务含义编码**。



# snowflake算法

* twitter开源的分布式id生成算法
* 核心思想就是：使用一个64 bit的long型的数字作为全局唯一id，这64个bit中，其中1个bit是不用的，然后用其中的41 bit作为毫秒数，用10 bit作为工作机器id，12 bit作为序列号
* 这个算法可以保证说，一个机房的一台机器上，在同一毫秒内，生成了一个唯一的id。可能一个毫秒内会生成多个id，但是有最后12个bit的序号来区分开来。